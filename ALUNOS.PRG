CLS
SET WRAP ON
SET DATE BRITISH
SET MESSAGE TO 23 CENTER
DO WHILE .T.
SET INTENSITY ON
SET COLOR TO B/W+
@ 00,00 CLEAR TO 24,79
@ 00,00 TO 24,79 DOUBLE
SET COLOR TO /GB,/GB
@ 01,01 CLEAR TO 02,78
SET COLOR TO N/BG
@ 01,15 SAY "APLICACAO PARA CADASTRO DE ALUNOS"
SET COLOR TO B/GB,W+/GB
@ 23,01 CLEAR TO 23,78
EU=0
@ 02,05 PROMPT "MENU DE OP��ES"
MENU TO EU
DO CASE
CASE EU=1
DEIVID=0
@ 03,04 CLEAR TO 10,20
@ 03,04 TO 10,20
@ 04,06 PROMPT "CADASTRO" MESSAGE "CADASTRO DE ALUNOS"
@ 05,06 PROMPT "LEITURA" MESSAGE "LEITURA DE ALUNOS"
@ 06,06 PROMPT "ALTERACAO" MESSAGE "ALTERACAO DE ALUNOS"
@ 07,06 PROMPT "EXCLUSAO" MESSAGE "EXCLUSAO DE ALUNOS"
@ 08,06 PROMPT "RELATORIO" MESSAGE "RELATORIO DE ALUNOS"
@ 09,06 PROMPT "SAIR" MESSAGE "FINALIZAR SISTEMA"
MENU TO DEIVID
DO CASE
CASE DEIVID=1
DO CADASTRO
CASE DEIVID=2
DO LEITURA 
CASE DEIVID=3
DO ALTERA
CASE DEIVID=4
DO EXCLUIR
CASE DEIVID=5
DO RELATORIO
CASE DEIVID=6
SET COLOR TO
CLS
EXIT
ENDCASE
ENDCASE
ENDDO

**************************************

*   PROGRAMA DE CADASTRO

**************************************

PROCEDURE CADASTRO
TELA=SAVESCREEN(00,00,24,79)
DO WHILE .T.
SET INTENSITY OFF
USE BANCO.DBF
SET COLOR TO B/BG,GR+/W+
@ 05,05 CLEAR TO 20,75
@ 05,05 TO 20,75
@ 06,20 SAY "CADASTRO DE ALUNOS"
@ 07,20 SAY "========= == ======="
VCODIGO=0
VNOME=SPACE(40)
VDATA=CTOD("  /  /  ")
VTEL=SPACE(15)
@ 08,07 SAY "CODIGO" GET VCODIGO PICTURE"9999"
READ

IF LASTKEY()=27
EXIT
ENDIF

LOCATE FOR VCODIGO=CODIGO

IF FOUND()
ALERT ("CODIGO JA CADASTRADO")
LOOP
ENDIF

@ 10,10 SAY "NOME" GET VNOME PICTURE"@!"
@ 14,10 SAY "DATA" GET VDATA
@ 16,10 SAY "TEL." GET VTEL
READ
APPEND BLANK
REPLACE CODIGO WITH VCODIGO
REPLACE NOME WITH VNOME
REPLACE DATA WITH VDATA
REPLACE TELEFONE WITH VTEL

VRESP="S"
@ 18,10 SAY SPACE(30)
@ 18,10 SAY "DESEJA CONTINUAR? (S/N)" GET VRESP PICT"@!" VALID VRESP $ "SN"
READ

IF LASTKEY()=27
EXIT
ENDIF

IF VRESP="N"
EXIT
ENDIF

@ 18,10 SAY SPACE(30)
ENDDO
RESTSCREEN(00,00,24,79,TELA)
USE


**************************************

*  PROGRAMA DE LEITURA

**************************************

PROCEDURE LEITURA
TELA=SAVESCREEN(00,00,24,79)
DO WHILE .T.
SET INTENSITY OFF
USE BANCO.DBF
SET COLOR TO B/BG,GR+/W+
@ 05,05 CLEAR TO 20,75
@ 05,05 TO 20,75
@ 06,28 SAY "LEITURA DE ALUNOS"
@ 07,28 SAY "======= == ======"
VCODIGO=0
@ 08,10 SAY "CODIGO" GET VCODIGO PICTURE"9999"
READ

IF LASTKEY()=27
EXIT
ENDIF

LOCATE FOR VCODIGO=CODIGO

IF .NOT. FOUND()
ALERT ("CODIGO NAO CADASTRADO")
LOOP
ENDIF

@ 10,15 SAY "NOME:"
@ 14,15 SAY "DATA:"
@ 16,15 SAY "TEL.:"
@ 10,25 SAY NOME
@ 14,25 SAY DATA
@ 16,25 SAY TELEFONE


VRESP="N"
@ 18,10 SAY SPACE(30)
@ 18,10 SAY "DESEJA CONTINUAR? (S/N)" GET VRESP PICT"@!" VALID VRESP $ "SN"
READ

IF LASTKEY()=27
EXIT
ENDIF

IF VRESP="N"
EXIT
RETURN .T.
ENDIF

@ 18,10 SAY SPACE(30)
ENDDO
RESTSCREEN(00,00,24,79,TELA)
RETURN .T.
USE

**************************************

*  PROGRAMA DE ALTERACAO

**************************************

PROCEDURE ALTERA
TELA=SAVESCREEN(00,00,24,79)
DO WHILE .T.
SET INTENSITY OFF
SET SCOREBOARD OFF
USE BANCO.DBF
SET COLOR TO B/BG,GR+/W+

@ 05,05 CLEAR TO 20,75
@ 05,05 TO 20,75
@ 06,20 SAY "ALTERA DE ALUNOS"
@ 07,20 SAY "====== == ======"

VCODIGO=0
VNOME=SPACE(40)
VDATA=CTOD("  /  /  ")
VTEL=SPACE(15)

@ 08,07 SAY "CODIGO" GET VCODIGO PICTURE"9999"
READ

IF LASTKEY()=27
EXIT
ENDIF

LOCATE FOR VCODIGO=CODIGO

IF .NOT. FOUND()
ALERT ("CODIGO NAO CADASTRADO")
LOOP
ENDIF

@ 10,10 SAY "NOME" GET NOME PICTURE"@!"
@ 14,10 SAY "DATA" GET DATA
@ 16,10 SAY "DATA" GET TELEFONE

READ
APPEND BLANK
REPLACE CODIGO WITH VCODIGO
REPLACE NOME WITH VNOME
REPLACE DATA WITH VDATA
REPLACE TELEFONE WITH VTEL

VRESP="S"
@ 18,10 SAY SPACE(30)
@ 18,10 SAY "DESEJA CONTINUAR? (S/N)" GET VRESP PICT"@!" VALID VRESP $ "SN"
READ

IF LASTKEY()=27
EXIT
ENDIF

IF VRESP="N"
EXIT
RETURN .T.
ENDIF

@ 18,10 SAY SPACE(30)
ENDDO
RESTSCREEN(00,00,24,79,TELA)
USE

**************************************

*  PROGRAMA DE EXCLUIR

**************************************

PROCEDURE EXCLUIR
TELA=SAVESCREEN(00,00,24,79)
DO WHILE .T.
SET SCOREBOARD OFF
SET INTENSITY OFF
USE BANCO.DBF
SET COLOR TO B/BG,GR+/W+
@ 05,05 CLEAR TO 20,75
@ 05,05 TO 20,75
@ 06,28 SAY "EXCLUSAO DE ALUNOS"
@ 07,28 SAY "======== == ======"

VCODIGO=0
@ 08,10 SAY "CODIGO" GET VCODIGO PICTURE"9999"
READ

IF LASTKEY()=27
EXIT
ENDIF

LOCATE FOR VCODIGO=CODIGO

IF .NOT. FOUND()
ALERT ("CODIGO NAO CADASTRADO")
LOOP
ENDIF

@ 10,15 SAY "NOME:"
@ 14,15 SAY "DATA:"
@ 10,25 SAY NOME
@ 14,25 SAY DATA

VRESP="S"
@ 18,10 SAY SPACE(30)
@ 18,10 SAY "DESEJA EXCLUIR? (S/N)" GET VRESP PICT"@!" VALID VRESP $ "SN"
READ

IF LASTKEY()=27
EXIT
ENDIF

IF VRESP="S"
DELETE
PACK
ENDIF


VRESP2="S"
@ 18,10 SAY SPACE(30)
@ 18,10 SAY "DESEJA SAIR? (S/N)" GET VRESP2 PICT"@!" VALID VRESP2 $ "SN"
READ

IF VRESP2="S"
EXIT
ENDIF


@ 18,10 SAY SPACE(30)
RESTSCREEN(00,00,24,79,TELA)
ENDDO
USE

**************************************

*  PROGRAMA DE RELATORIO

**************************************

PROCEDURE RELATORIO

SET COLOR TO B/BG,GR+/W+
@ 12,13 CLEAR TO 16,35
@ 12,13 TO 16,35 DOUBLE
USE BANCO.DBF

VRESP=" "
@ 14,15 SAY "IMPRIMIR? (S/N)" GET VRESP PICT"@!" VALID VRESP $ "SN"
READ

IF VRESP="N"
@ 07,13 CLEAR TO 20,77
RETURN
ENDIF

IF .NOT. ISPRINTER()
ALERT ("IMPRESSORA COM PROBLEMAS VERIFIQUE")
RETURN
ENDIF

SET DEVICE TO PRINT
GO TOP  //COLOCA O PONTEIRO NO INICIO DO LACO

DO WHILE .NOT. EOF()   //REPETIR SEMPRE QUE O PONTEIRO ESTIVER NO INICIO DO LA�O
@ PROW()+3,04 SAY "CODIGO"
@ PROW()  ,14 SAY "NOME"
@ PROW()  ,47 SAY "DATA"

DO WHILE .NOT. EOF()
@ PROW()+1,04 SAY CODIGO
@ PROW()  ,14 SAY NOME
@ PROW()  ,47 SAY DATA
SKIP +1

IF PROW() > 57
EJECT   //ESTIPULA UM SALTOP DE P�GINA
EXIT
ENDIF

ENDDO
EJECT
ENDDO

SET DEVICE TO SCREEN
@ 07,13 CLEAR TO 20,77
USE
